' Gambas class file

Public Sub Form_Open()
  
  txtHorasLunes.Text = "0"
  txtHorasMartes.Text = "0"
  txtHorasMiercoles.Text = "0"
  txtHorasJueves.Text = "0"
  txtHorasViernes.Text = "0"
  txtHorasSabado.Text = "0"
  txtHorasDomingo.Text = "0"
  
  ComboMeses()
  
End

Public Sub tplMeses_MouseDown()
  
End

Public Sub dcDate_Click()
  
End

Public Sub btnAplicar_Click()
  
End

Public Sub txtHorasLunes_Change()
  
  Recalcular()
  
End

Public Sub txtHorasMartes_Change()
  
  Recalcular()
  
End

Public Sub txtHorasMiercoles_Change()
  
  Recalcular()
  
End

Public Sub txtHorasJueves_Change()
  
  Recalcular()
  
End

Public Sub txtHorasViernes_Change()
  
  Recalcular()
  
End

Public Sub txtHorasSabado_Change()
  
  Recalcular()
  
End

Public Sub txtHorasDomingo_Change()
  
  Recalcular()
  
End

Public Sub Recalcular()
  
  txtHorasTotal.Value = CFloat(txtHorasLunes.Value) + CFloat(txtHorasMartes.Value) + CFloat(txtHorasMiercoles.Value) + CFloat(txtHorasJueves.Value) + CFloat(txtHorasViernes.Value) + CFloat(txtHorasSabado.Value) + CFloat(txtHorasDomingo.Value)
  
  If txtHorasTotal.value < 40 Then 
    txtHorasTotal.Background = Color.RGB(0, 167, 253)
  Else If txtHorasTotal.value = 40
    txtHorasTotal.Background = Color.RGB(71, 200, 119)   
  Else
    txtHorasTotal.Background = Color.Red
    lblStatus.text = "Se exceden las horas semanales"
    Return
  End If
  
  ' Se evalua si Sabado o Domingo se incluye horario
  If txtHorasSabado.value > 0 Or txtHorasDomingo.value > 0 Then
    lblStatus.text = "Hay horarios indicados en d√≠as festivos!"
  Else 
    lblStatus.text = Null
  End If
  
End

Public Sub ComboMeses()
  
  cmbMes.Clear()
  
  cmbMes.Add("-- mes --", 0)
  cmbMes.Add("Enero", 1)
  cmbMes.Add("Febrero", 2)
  cmbMes.Add("Marzo", 3)
  cmbMes.Add("Abril", 4)
  cmbMes.Add("Mayo", 5)
  cmbMes.Add("Junio", 6)
  cmbMes.Add("Julio", 7)
  cmbMes.Add("Agosto", 8)
  cmbMes.Add("Septiembre", 9)
  cmbMes.Add("Octubre", 10)
  cmbMes.Add("Noviembre", 11)
  cmbMes.Add("Diciembre", 12)
  
End

Public Sub ComboAnyo()
  
  cmbAnyo.Clear
  
End
