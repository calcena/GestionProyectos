' Gambas class file

Private rstResultado As Result
Private sFiltro As String = "%"

Public Sub btnCalcular_Click()
  
  Dim inicio As String = Time(Now)
  Dim fin As String
  
  TextBox1.Text = "Inicio: " & inicio
  Wait
  ' cargamos el resulset
  rstResultado = cTest.GetValues(sFiltro)
  ' pintamos el grid
  GridView1 = cTest.GetGrid(GridView1, rstResultado)
  
  TextBox1.Text &= "\r\n"
  fin = Time(Now)
  TextBox1.Text &= "Fin:     " & fin
  TextBox1.Text &= "\r\n"
  TextBox1.Text &= "------------------------------------------"
  
  ''TextBox1.Text &= "\r\nEjecuci√≥n: " & (CFloat(fin) - CFloat(inicio))
  
End

Public Sub TextBox2_KeyRelease()
  
  sFiltro = TextBox2.Text
  
  btnCalcular_Click
  
End
