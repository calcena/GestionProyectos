' Gambas class file

Private rstResultado As Result
Private sFiltro As String = "%"
Private sEstado As String = "%"

Public Sub btnSalir2_Click()
  
  Me.Close()
  MenuPrincipal.Show()
  
End

Public Sub Form_Open()
  ' Cargamos el ResultSet con los filtros
  
  CargarGrid()
  
  ComboRoles()
  
End

Public Sub ComboRoles()
  
  cmbRol.Clear()
  
  rstResultado = cRoles.GetAllRoles()
  
  rstResultado.MoveFirst
  
  Do While rstResultado.Available
    
    cmbRol.Add(rstResultado!NOMBRE, rstResultado!ID_ROL)
    
    rstResultado.MoveNext  
  Loop
  
End

Public Sub txtFiltroUsuarios_KeyRelease()
  
  sFiltro = txtFiltroUsuarios.Text
  CargarGrid()
  
End

Public Sub GetRows() 
  
  Dim resultado As String 
  
  resultado = CStr(rstResultado.Count)
  lblRegistros.Text = "Registros: " & resultado 
  
End

Public Sub CargarGrid()  
  
  rstResultado = cUsuarios.GetUsers(sFiltro, sEstado)
  ' obtenemos los registro para pintar el grid  
  grvUsuarios = cUsuarios.GetGrid(grvUsuarios, rstResultado)
  
  GetRows()
  
End
